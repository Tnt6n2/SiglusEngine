#include	"pch.h"
#include	"engine/eng_mask_wipe.h"

// ****************************************************************
// マスクテクスチャ作成：８×８
// ================================================================

bool tnm_make_32bit_mask_for_8x8(S_mask_buffer *buf, bool gray_reverse, int pat_w, int pat_h, BYTE *color_map)
{
	BYTE *dp;
	int ex1, ey1, ex2, ey2;
	if (!tnm_alloc_mask_buffer(buf, pat_w * 8, pat_h * 8, &dp, &ex1, &ey1, &ex2, &ey2))	{	return false;	}

	BYTE *cm = color_map;
	int y = 0;
	for(int i = 0; i < 8; i++)	{
		int x = 0;
		for (int j = 0; j < 8; j++)	{
			tnm_draw_32bit_fill_box(dp, buf->w, buf->h, x, y, (x + pat_w - 1), (y + pat_h - 1), *cm, gray_reverse, ex1, ey1, ex2, ey2);
			x += pat_w;
			cm++;
		}
		y += pat_h;
	}
	return true;
}

bool tnm_make_mask_texture_for_8x8(BSP<C_d3d_texture> *texture, int target_w, int target_h, bool gray_reverse, int pat_w, int pat_h, BYTE *color_map)
{
	pat_w = limit(1, pat_w, 64);
	pat_h = limit(1, pat_h, 64);
	S_mask_buffer buf;
	if (!tnm_make_32bit_mask_for_8x8(&buf, gray_reverse, pat_w, pat_h, color_map))	{	return false;	}
	return tnm_make_mask_texture_with_duplicate(texture, target_w, target_h, &buf);
}

// ****************************************************************
// マスクテクスチャ作成：８×８の回るように
// ================================================================
bool tnm_make_mask_texture_for_8x8_turn_around(BSP<C_d3d_texture> *texture, int target_w, int target_h, bool gray_reverse, int pat_w, int pat_h, int pat_mod)
{
	BYTE color_map[8][64] = 
	{
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
		146, 142, 138, 134, 130, 126, 121, 223,		// □□□□□□□□
		150,  65,  61,  56,  52,  48, 117, 219,		// □□□□□□□□
		154,  69,  16,  12,   8,  44, 113, 215,		// □□□□□□□□
		158,  73,  20,   0,   4,  40, 109, 211,		// □□□□□□□□
		162,  77,  24,  28,  32,  36, 105, 207,		// □□□□□□□□
		166,  81,  85,  89,  93,  97, 101, 203,		// □□□□□□□□
		170, 174, 178, 182, 186, 191, 195, 199,		// □□□□□□□□
										 
		170, 166, 162, 158, 154, 150, 146, 255,		// □□□□□□□↓
		174,  81,  77,  73,  69,  65, 142, 251,		// □□□□□□□□
		178,  85,  24,  20,  16,  61, 138, 247,		// □□□□□□□□
		182,  89,  28,   0,  12,  56, 134, 243,		// □□□□□□□□
		186,  93,  32,   4,   8,  52, 130, 239,		// □□□□□□□□
		191,  97,  36,  40,  44,  48, 126, 235,		// □□□□□□□□
		195, 101, 105, 109, 113, 117, 121, 231,		// □□□□□□□□
		199, 203, 207, 211, 215, 219, 223, 227,		// □□□□□□□□
										 
		199, 195, 191, 186, 182, 178, 174, 170,		// □□□□□□□□
		203, 101,  97,  93,  89,  85,  81, 166,		// □□□□□□□□
		207, 105,  36,  32,  28,  24,  77, 162,		// □□□□□□□□
		211, 109,  40,   4,   0,  20,  73, 158,		// □□□□□□□□
		215, 113,  44,   8,  12,  16,  69, 154,		// □□□□□□□□
		219, 117,  48,  52,  56,  61,  65, 150,		// □□□□□□□□
		223, 121, 126, 130, 134, 138, 142, 146,		// □□□□□□□□
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
										 
		227, 223, 219, 215, 211, 207, 203, 199,		// □□□□□□□□
		231, 121, 117, 113, 109, 105, 101, 195,		// □□□□□□□□
		235, 126,  48,  44,  40,  36,  97, 191,		// □□□□□□□□
		239, 130,  52,   8,   4,  32,  93, 186,		// □□□□□□□□
		243, 134,  56,  12,   0,  28,  89, 182,		// □□□□□□□□
		247, 138,  61,  16,  20,  24,  85, 178,		// □□□□□□□□
		251, 142,  65,  69,  73,  77,  81, 174,		// □□□□□□□□
		255, 146, 150, 154, 158, 162, 166, 170,		// ↑□□□□□□□
										 
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
		223, 121, 126, 130, 134, 138, 142, 146,		// □□□□□□□□
		219, 117,  48,  52,  56,  61,  65, 150,		// □□□□□□□□
		215, 113,  44,   8,  12,  16,  69, 154,		// □□□□□□□□
		211, 109,  40,   4,   0,  20,  73, 158,		// □□□□□□□□
		207, 105,  36,  32,  28,  24,  77, 162,		// □□□□□□□□
		203, 101,  97,  93,  89,  85,  81, 166,		// □□□□□□□□
		199, 195, 191, 186, 182, 178, 174, 170,		// □□□□□□□□
										 
		255, 146, 150, 154, 158, 162, 166, 170,		// ↓□□□□□□□
		251, 142,  65,  69,  73,  77,  81, 174,		// □□□□□□□□
		247, 138,  61,  16,  20,  24,  85, 178,		// □□□□□□□□
		243, 134,  56,  12,   0,  28,  89, 182,		// □□□□□□□□
		239, 130,  52,   8,   4,  32,  93, 186,		// □□□□□□□□
		235, 126,  48,  44,  40,  36,  97, 191,		// □□□□□□□□
		231, 121, 117, 113, 109, 105, 101, 195,		// □□□□□□□□
		227, 223, 219, 215, 211, 207, 203, 199,		// □□□□□□□□
										 
		170, 174, 178, 182, 186, 191, 195, 199,		// □□□□□□□□
		166,  81,  85,  89,  93,  97, 101, 203,		// □□□□□□□□
		162,  77,  24,  28,  32,  36, 105, 207,		// □□□□□□□□
		158,  73,  20,   0,   4,  40, 109, 211,		// □□□□□□□□
		154,  69,  16,  12,   8,  44, 113, 215,		// □□□□□□□□
		150,  65,  61,  56,  52,  48, 117, 219,		// □□□□□□□□
		146, 142, 138, 134, 130, 126, 121, 223,		// □□□□□□□□
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
										 
		199, 203, 207, 211, 215, 219, 223, 227,		// □□□□□□□□
		195, 101, 105, 109, 113, 117, 121, 231,		// □□□□□□□□
		191,  97,  36,  40,  44,  48, 126, 235,		// □□□□□□□□
		186,  93,  32,   4,   8,  52, 130, 239,		// □□□□□□□□
		182,  89,  28,   0,  12,  56, 134, 243,		// □□□□□□□□
		178,  85,  24,  20,  16,  61, 138, 247,		// □□□□□□□□
		174,  81,  77,  73,  69,  65, 142, 251,		// □□□□□□□□
		170, 166, 162, 158, 154, 150, 146, 255,		// □□□□□□□↑
	};
	if (!(0 <= pat_mod && pat_mod < 8))	{	pat_mod = 0;	}
	return tnm_make_mask_texture_for_8x8(texture, target_w, target_h, gray_reverse, pat_w, pat_h, color_map[pat_mod]);
}

// ****************************************************************
// マスクテクスチャ作成：８×８の改行すように
// ================================================================
bool tnm_make_mask_texture_for_8x8_turn_ret(BSP<C_d3d_texture> *texture, int target_w, int target_h, bool gray_reverse, int pat_w, int pat_h, int pat_mod)
{
	BYTE color_map[8][64] = 
	{
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
		223, 219, 215, 211, 207, 203, 199, 195,		// □□□□□□□□
		191, 186, 182, 178, 174, 170, 166, 162,		// □□□□□□□□
		158, 154, 150, 146, 142, 138, 134, 130,		// □□□□□□□□
		126, 121, 117, 113, 109, 105, 101,  97,		// □□□□□□□□
		 93,  89,  85,  81,  77,  73,  69,  65,		// □□□□□□□□
		 61,  56,  52,  48,  44,  40,  36,  32,		// □□□□□□□□
		 28,  24,  20,  16,  12,   8,   4,   0,		// □□□□□□□□
								   
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
		195, 199, 203, 207, 211, 215, 219, 223,		// □□□□□□□□
		162, 166, 170, 174, 178, 182, 186, 191,		// □□□□□□□□
		130, 134, 138, 142, 146, 150, 154, 158,		// □□□□□□□□
		 97, 101, 105, 109, 113, 117, 121, 126,		// □□□□□□□□
		 65,  69,  73,  77,  81,  85,  89,  93,		// □□□□□□□□
		 32,  36,  40,  44,  48,  52,  56,  61,		// □□□□□□□□
		  0,   4,   8,  12,  16,  20,  24,  28,		// □□□□□□□□
								   
		 28,  24,  20,  16,  12,   8,   4,   0,		// □□□□□□□□
		 61,  56,  52,  48,  44,  40,  36,  32,		// □□□□□□□□
		 93,  89,  85,  81,  77,  73,  69,  65,		// □□□□□□□□
		126, 121, 117, 113, 109, 105, 101,  97,		// □□□□□□□□
		158, 154, 150, 146, 142, 138, 134, 130,		// □□□□□□□□
		191, 186, 182, 178, 174, 170, 166, 162,		// □□□□□□□□
		223, 219, 215, 211, 207, 203, 199, 195,		// □□□□□□□□
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
								   
		  0,   4,   8,  12,  16,  20,  24,  28,		// □□□□□□□□
		 32,  36,  40,  44,  48,  52,  56,  61,		// □□□□□□□□
		 65,  69,  73,  77,  81,  85,  89,  93,		// □□□□□□□□
		 97, 101, 105, 109, 113, 117, 121, 126,		// □□□□□□□□
		130, 134, 138, 142, 146, 150, 154, 158,		// □□□□□□□□
		162, 166, 170, 174, 178, 182, 186, 191,		// □□□□□□□□
		195, 199, 203, 207, 211, 215, 219, 223,		// □□□□□□□□
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
								   
		255, 223, 191, 158, 126,  93,  61,  28,		// ↓□□□□□□□
		251, 219, 186, 154, 121,  89,  56,  24,		// □□□□□□□□
		247, 215, 182, 150, 117,  85,  52,  20,		// □□□□□□□□
		243, 211, 178, 146, 113,  81,  48,  16,		// □□□□□□□□
		239, 207, 174, 142, 109,  77,  44,  12,		// □□□□□□□□
		235, 203, 170, 138, 105,  73,  40,   8,		// □□□□□□□□
		231, 199, 166, 134, 101,  69,  36,   4,		// □□□□□□□□
		227, 195, 162, 130,  97,  65,  32,   0,		// □□□□□□□□
								   
		227, 195, 162, 130,  97,  65,  32,   0,		// □□□□□□□□
		231, 199, 166, 134, 101,  69,  36,   4,		// □□□□□□□□
		235, 203, 170, 138, 105,  73,  40,   8,		// □□□□□□□□
		239, 207, 174, 142, 109,  77,  44,  12,		// □□□□□□□□
		243, 211, 178, 146, 113,  81,  48,  16,		// □□□□□□□□
		247, 215, 182, 150, 117,  85,  52,  20,		// □□□□□□□□
		251, 219, 186, 154, 121,  89,  56,  24,		// □□□□□□□□
		255, 223, 191, 158, 126,  93,  61,  28,		// ↑□□□□□□□
								   
		 28,  61,  93, 126, 158, 191, 223, 255,		// □□□□□□□↓
		 24,  56,  89, 121, 154, 186, 219, 251,		// □□□□□□□□
		 20,  52,  85, 117, 150, 182, 215, 247,		// □□□□□□□□
		 16,  48,  81, 113, 146, 178, 211, 243,		// □□□□□□□□
		 12,  44,  77, 109, 142, 174, 207, 239,		// □□□□□□□□
		  8,  40,  73, 105, 138, 170, 203, 235,		// □□□□□□□□
		  4,  36,  69, 101, 134, 166, 199, 231,		// □□□□□□□□
		  0,  32,  65,  97, 130, 162, 195, 227,		// □□□□□□□□
								   
		  0,  32,  65,  97, 130, 162, 195, 227,		// □□□□□□□□
		  4,  36,  69, 101, 134, 166, 199, 231,		// □□□□□□□□
		  8,  40,  73, 105, 138, 170, 203, 235,		// □□□□□□□□
		 12,  44,  77, 109, 142, 174, 207, 239,		// □□□□□□□□
		 16,  48,  81, 113, 146, 178, 211, 243,		// □□□□□□□□
		 20,  52,  85, 117, 150, 182, 215, 247,		// □□□□□□□□
		 24,  56,  89, 121, 154, 186, 219, 251,		// □□□□□□□□
		 28,  61,  93, 126, 158, 191, 223, 255,		// □□□□□□□↑
	};
	if (!(0 <= pat_mod && pat_mod < 8))	{	pat_mod = 0;	}
	return tnm_make_mask_texture_for_8x8(texture, target_w, target_h, gray_reverse, pat_w, pat_h, color_map[pat_mod]);
}

// ****************************************************************
// マスクテクスチャ作成：８×８の折り返すように
// ================================================================
bool tnm_make_mask_texture_for_8x8_turn_down(BSP<C_d3d_texture> *texture, int target_w, int target_h, bool gray_reverse, int pat_w, int pat_h, int pat_mod)
{
	BYTE color_map[8][64] = 
	{
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
		195, 199, 203, 207, 211, 215, 219, 223,		// □□□□□□□□
		191, 186, 182, 178, 174, 170, 166, 162,		// □□□□□□□□
		130, 134, 138, 142, 146, 150, 154, 158,		// □□□□□□□□
		126, 121, 117, 113, 109, 105, 101,  97,		// □□□□□□□□
		 65,  69,  73,  77,  81,  85,  89,  93,		// □□□□□□□□
		 61,  56,  52,  48,  44,  40,  36,  32,		// □□□□□□□□
		  0,   4,   8,  12,  16,  20,  24,  28,		// □□□□□□□□
										 
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
		223, 219, 215, 211, 207, 203, 199, 195,		// □□□□□□□□
		162, 166, 170, 174, 178, 182, 186, 191,		// □□□□□□□□
		158, 154, 150, 146, 142, 138, 134, 130,		// □□□□□□□□
		 97, 101, 105, 109, 113, 117, 121, 126,		// □□□□□□□□
		 93,  89,  85,  81,  77,  73,  69,  65,		// □□□□□□□□
		 32,  36,  40,  44,  48,  52,  56,  61,		// □□□□□□□□
		 28,  24,  20,  16,  12,   8,   4,   0,		// □□□□□□□□
										 
		  0,   4,   8,  12,  16,  20,  24,  28,		// □□□□□□□□
		 61,  56,  52,  48,  44,  40,  36,  32,		// □□□□□□□□
		 65,  69,  73,  77,  81,  85,  89,  93,		// □□□□□□□□
		126, 121, 117, 113, 109, 105, 101,  97,		// □□□□□□□□
		130, 134, 138, 142, 146, 150, 154, 158,		// □□□□□□□□
		191, 186, 182, 178, 174, 170, 166, 162,		// □□□□□□□□
		195, 199, 203, 207, 211, 215, 219, 223,		// □□□□□□□□
		255, 251, 247, 243, 239, 235, 231, 227,		// →□□□□□□□
										 
		 28,  24,  20,  16,  12,   8,   4,   0,		// □□□□□□□□
		 32,  36,  40,  44,  48,  52,  56,  61,		// □□□□□□□□
		 93,  89,  85,  81,  77,  73,  69,  65,		// □□□□□□□□
		 97, 101, 105, 109, 113, 117, 121, 126,		// □□□□□□□□
		158, 154, 150, 146, 142, 138, 134, 130,		// □□□□□□□□
		162, 166, 170, 174, 178, 182, 186, 191,		// □□□□□□□□
		223, 219, 215, 211, 207, 203, 199, 195,		// □□□□□□□□
		227, 231, 235, 239, 243, 247, 251, 255,		// □□□□□□□←
										 
		255, 195, 191, 130, 126,  65,  61,   0,		// ↓□□□□□□□
		251, 199, 186, 134, 121,  69,  56,   4,		// □□□□□□□□
		247, 203, 182, 138, 117,  73,  52,   8,		// □□□□□□□□
		243, 207, 178, 142, 113,  77,  48,  12,		// □□□□□□□□
		239, 211, 174, 146, 109,  81,  44,  16,		// □□□□□□□□
		235, 215, 170, 150, 105,  85,  40,  20,		// □□□□□□□□
		231, 219, 166, 154, 101,  89,  36,  24,		// □□□□□□□□
		227, 223, 162, 158,  97,  93,  32,  28,		// □□□□□□□□
										 
		227, 223, 162, 158,  97,  93,  32,  28,		// □□□□□□□□
		231, 219, 166, 154, 101,  89,  36,  24,		// □□□□□□□□
		235, 215, 170, 150, 105,  85,  40,  20,		// □□□□□□□□
		239, 211, 174, 146, 109,  81,  44,  16,		// □□□□□□□□
		243, 207, 178, 142, 113,  77,  48,  12,		// □□□□□□□□
		247, 203, 182, 138, 117,  73,  52,   8,		// □□□□□□□□
		251, 199, 186, 134, 121,  69,  56,   4,		// □□□□□□□□
		255, 195, 191, 130, 126,  65,  61,   0,		// ↑□□□□□□□
										 
		  0,  61,  65, 126, 130, 191, 195, 255,		// □□□□□□□↓
		  4,  56,  69, 121, 134, 186, 199, 251,		// □□□□□□□□
		  8,  52,  73, 117, 138, 182, 203, 247,		// □□□□□□□□
		 12,  48,  77, 113, 142, 178, 207, 243,		// □□□□□□□□
		 16,  44,  81, 109, 146, 174, 211, 239,		// □□□□□□□□
		 20,  40,  85, 105, 150, 170, 215, 235,		// □□□□□□□□
		 24,  36,  89, 101, 154, 166, 219, 231,		// □□□□□□□□
		 28,  32,  93,  97, 158, 162, 223, 227,		// □□□□□□□□
										 
		 28,  32,  93,  97, 158, 162, 223, 227,		// □□□□□□□□
		 24,  36,  89, 101, 154, 166, 219, 231,		// □□□□□□□□
		 20,  40,  85, 105, 150, 170, 215, 235,		// □□□□□□□□
		 16,  44,  81, 109, 146, 174, 211, 239,		// □□□□□□□□
		 12,  48,  77, 113, 142, 178, 207, 243,		// □□□□□□□□
		  8,  52,  73, 117, 138, 182, 203, 247,		// □□□□□□□□
		  4,  56,  69, 121, 134, 186, 199, 251,		// □□□□□□□□
		  0,  61,  65, 126, 130, 191, 195, 255,		// □□□□□□□↑
	};
	if (!(0 <= pat_mod && pat_mod < 8))	{	pat_mod = 0;	}
	return tnm_make_mask_texture_for_8x8(texture, target_w, target_h, gray_reverse, pat_w, pat_h, color_map[pat_mod]);
}

